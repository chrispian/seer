name: AI News Digest
slug: news-digest-ai
version: 1.0.0
requires: { secrets: [], capabilities: ["ai.generate","fragment.create","tool.call"] }
steps:
  - id: window
    type: transform
    template: "{ \"from\": \"{{ ctx.now }}\", \"to\": \"{{ ctx.now }}\" }"
  - id: fetch
    type: tool.call
    with:
      name: "mcp"
      args:
        server: "news"
        method: "fetch"
        params: { query: "AI", from: "{{ steps.window.output.from }}", to: "{{ steps.window.output.to }}" }
  - id: rank
    type: ai.generate
    prompt: "Rank and summarize top 10-15 items (JSON)"
    expect: json
  - id: compose
    type: ai.generate
    prompt: "Compose markdown newsletter from ranked items: {{ steps.rank.output }}"
    expect: text
  - id: persist
    type: fragment.create
    with:
      type: document
      title: "AI News Digest â€” {{ ctx.now }}"
      content: "{{ steps.compose.output }}"
      tags: ["newsletter","ai"]
