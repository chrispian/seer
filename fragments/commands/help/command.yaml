name: "Help System"
slug: help
version: 2.0.0
triggers:
  slash: "/help"
  aliases: []
  input_mode: "inline"
reserved: true

requires:
  secrets: []
  capabilities: []

steps:
  - id: determine-section
    type: condition
    condition: "{{ ctx.identifier | length > 0 }}"
    then:
      # Show specific section help
      - id: build-section-help
        type: transform
        template: |
          # {{ ctx.identifier | capitalize }} Help

          Available help sections:
          - `/help recall` â€“ Recall Commands
          - `/help bookmark` â€“ Bookmark Commands  
          - `/help fragment` â€“ Fragment Commands
          - `/help todo` â€“ Todo Management
          - `/help search` â€“ Search Commands
          - `/help join` â€“ Channel Navigation
          - `/help session` â€“ Sessions
          - `/help system` â€“ System Management
          - `/help tools` â€“ Chat Tools

          Use `/help` without arguments to see all commands.
          
          **Note**: Specific section help content is being migrated. For now, use `/help` to see all commands.
      - id: show-section-panel
        type: response.panel
        with:
          type: "help"
          panel_data:
            message: "{{ steps.build-section-help.output }}"
    else:
      # Show all sections
      - id: build-full-help
        type: transform
        template: |
          # Commands Cheat Sheet

          Here are the commands you can use in the chat:

          ## Recall Commands
          - `/recall type:todo limit:5` â€“ Recall recent fragments by type
          - `/recall session {hint}` â€“ Recall all fragments from a saved session (coming soon ðŸš€)

          ## Bookmark Commands
          - `/bookmark` â€“ Bookmark the most recent fragment
          - `/bookmark list` â€“ List saved bookmarks
          - `/bookmark show {hint}` â€“ Replay a bookmark in the chat
          - `/bookmark forget {hint}` â€“ Delete a saved bookmark

          ## Fragment Commands
          - `/frag This is something worth remembering` â€“ Log a fragment
          - `/todo Fix the login bug #urgent` â€“ Create a new todo fragment with tags

          ## Todo Management
          - `/todo` â€“ List 25 open todos (newest first)
          - `/todo list` â€“ List 25 open todos (explicit)
          - `/todo list status:completed` â€“ List completed todos
          - `/todo list #urgent limit:5` â€“ List 5 urgent todos
          - `/todo list search:client` â€“ Search todos for "client"
          - `/todo complete:1` â€“ Mark first todo complete
          - `/todo complete:"login bug"` â€“ Mark matching todo complete

          ## Search Commands
          - `/search your query here` â€“ Search all fragments with hybrid search
          - `/s your query here` â€“ Shorthand for search

          ## Channel Navigation
          - `/join #c5` â€“ Join channel #c5 by short code
          - `/join #custom` â€“ Join channel by custom name  
          - `/join #` â€“ Show all available channels
          - `/join bug` â€“ Search for channels containing "bug"
          - `/j #c1` â€“ Shorthand for join (alias)

          **Examples:**
          - `/join #c1` â€“ Switch to channel #c1 (by short code)
          - `/join #ProjectAlpha` â€“ Switch to channel named "ProjectAlpha"
          - `/join project` â€“ Find channels about "project"
          - `/join #` â€“ Browse all active channels

          **Related Commands:**
          - `/channels` â€“ List all available channels
          - `/name Custom Name` â€“ Rename current channel

          ## Sessions
          - `/session vault:work type:meeting Project Sync #weekly` â€“ Start a scoped session for all new fragments
          - `/session show` â€“ Display current active session details
          - `/session end` â€“ End the current session and return to normal logging

          Sessions automatically attach vault, type, tags, and a session key to all fragments you create while active.

          ## System Management
          - `/inbox` â€“ Open Inbox Management Interface for fragment review
          - `/types` â€“ Open Type System Management to view type packs and validation
          - `/scheduler` â€“ Open Scheduler Management for automation and scheduled commands

          ## Chat Tools
          - `/clear` â€“ Clear the current chat view
          - `/help` â€“ Show this help message

          ---
          All fragments are stored and processed. Bookmarks and sessions give you quick access to curated memories and grouped ideas.

      - id: show-full-panel
        type: response.panel
        with:
          type: "help"
          panel_data:
            message: "{{ steps.build-full-help.output }}"